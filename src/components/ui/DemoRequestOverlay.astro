---
/**
 * DemoRequestOverlay - Editorial Magazine Style Demo Request Panel
 * Full viewport overlay with 2/3 editorial content + 1/3 interactive form
 * Triggered from footer "Get Your Free Demo" button
 */
import { Image } from 'astro:assets';
import hyperscalersBg from '../../assets/hyperscalers.jpg';
---

<!-- Overlay Backdrop -->
<div id="demo-overlay" class="demo-overlay" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="demo-title">

  <!-- Close Button -->
  <button class="demo-overlay__close" aria-label="Close demo request form" type="button">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  </button>

  <div class="demo-overlay__container">

    <!-- LEFT PANEL: Editorial Magazine Style -->
    <div class="demo-overlay__editorial">
      <!-- Background Image with Fade -->
      <div class="demo-overlay__bg">
        <Image
          src={hyperscalersBg}
          alt=""
          class="demo-overlay__bg-image"
          loading="eager"
        />
        <div class="demo-overlay__bg-gradient"></div>
      </div>

      <!-- Editorial Content -->
      <div class="demo-overlay__content">
        <!-- Eyebrow -->
        <span class="demo-overlay__eyebrow">
          <span class="demo-overlay__eyebrow-line"></span>
          Experience the Platform
        </span>

        <!-- Magazine Headline -->
        <h2 id="demo-title" class="demo-overlay__headline">
          See What Your
          <span class="demo-overlay__headline-accent">Network</span>
          Has Been Hiding
        </h2>

        <!-- Subheadline -->
        <p class="demo-overlay__subhead">
          30-minute personalized walkthrough of DART AI's capabilities,
          tailored to your infrastructure challenges.
        </p>

        <!-- Trust Indicators -->
        <div class="demo-overlay__trust">
          <div class="demo-overlay__trust-item">
            <span class="demo-overlay__trust-number">15min</span>
            <span class="demo-overlay__trust-label">Setup Time</span>
          </div>
          <div class="demo-overlay__trust-divider"></div>
          <div class="demo-overlay__trust-item">
            <span class="demo-overlay__trust-number">99.9%</span>
            <span class="demo-overlay__trust-label">Uptime SLA</span>
          </div>
          <div class="demo-overlay__trust-divider"></div>
          <div class="demo-overlay__trust-item">
            <span class="demo-overlay__trust-number">24/7</span>
            <span class="demo-overlay__trust-label">Expert Support</span>
          </div>
        </div>

        <!-- Bottom Quote -->
        <blockquote class="demo-overlay__quote">
          <p>"DART AI detected issues we'd been blind to for months. The ROI was immediate."</p>
          <cite>â€” Network Operations Director, Fortune 500 Telecom</cite>
        </blockquote>
      </div>
    </div>

    <!-- RIGHT PANEL: Interactive Form -->
    <div class="demo-overlay__form-panel">
      <div class="demo-overlay__form-inner">

        <!-- Form Header -->
        <div class="demo-overlay__form-header">
          <h3 class="demo-overlay__form-title">Request Your Demo</h3>
          <p class="demo-overlay__form-subtitle">Let's explore what's possible together</p>
        </div>

        <!-- The Form -->
        <form id="demo-request-form" class="demo-overlay__form" novalidate>

          <!-- Name Fields Row -->
          <div class="demo-overlay__form-row">
            <div class="demo-overlay__field">
              <label for="demo-first-name" class="demo-overlay__label">First Name</label>
              <input
                type="text"
                id="demo-first-name"
                name="firstName"
                class="demo-overlay__input"
                placeholder="John"
                required
                autocomplete="given-name"
              />
              <span class="demo-overlay__field-focus"></span>
            </div>
            <div class="demo-overlay__field">
              <label for="demo-last-name" class="demo-overlay__label">Last Name</label>
              <input
                type="text"
                id="demo-last-name"
                name="lastName"
                class="demo-overlay__input"
                placeholder="Smith"
                required
                autocomplete="family-name"
              />
              <span class="demo-overlay__field-focus"></span>
            </div>
          </div>

          <!-- Work Email -->
          <div class="demo-overlay__field">
            <label for="demo-email" class="demo-overlay__label">Work Email</label>
            <input
              type="email"
              id="demo-email"
              name="email"
              class="demo-overlay__input"
              placeholder="john@company.com"
              required
              autocomplete="email"
            />
            <span class="demo-overlay__field-focus"></span>
          </div>

          <!-- Company -->
          <div class="demo-overlay__field">
            <label for="demo-company" class="demo-overlay__label">Company</label>
            <input
              type="text"
              id="demo-company"
              name="company"
              class="demo-overlay__input"
              placeholder="Acme Corporation"
              required
              autocomplete="organization"
            />
            <span class="demo-overlay__field-focus"></span>
          </div>

          <!-- Job Title -->
          <div class="demo-overlay__field">
            <label for="demo-title" class="demo-overlay__label">Job Title</label>
            <input
              type="text"
              id="demo-title"
              name="jobTitle"
              class="demo-overlay__input"
              placeholder="Network Operations Manager"
              autocomplete="organization-title"
            />
            <span class="demo-overlay__field-focus"></span>
          </div>

          <!-- Infrastructure Type -->
          <div class="demo-overlay__field">
            <label for="demo-infrastructure" class="demo-overlay__label">Primary Infrastructure</label>
            <div class="demo-overlay__select-wrapper">
              <select
                id="demo-infrastructure"
                name="infrastructure"
                class="demo-overlay__select"
                required
              >
                <option value="" disabled selected>Select your environment</option>
                <option value="mobile">Mobile Networks / RAN</option>
                <option value="broadband">Broadband / Home Networks</option>
                <option value="private">Private Networks / Enterprise</option>
                <option value="cloud">Cloud Infrastructure</option>
                <option value="iot">IoT / Sensor Networks</option>
                <option value="hybrid">Hybrid / Multi-Cloud</option>
                <option value="other">Other</option>
              </select>
              <svg class="demo-overlay__select-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="6 9 12 15 18 9"></polyline>
              </svg>
            </div>
            <span class="demo-overlay__field-focus"></span>
          </div>

          <!-- Message / Challenge -->
          <div class="demo-overlay__field">
            <label for="demo-challenge" class="demo-overlay__label">What's your biggest network challenge?</label>
            <textarea
              id="demo-challenge"
              name="challenge"
              class="demo-overlay__textarea"
              placeholder="Tell us about the visibility gaps or performance issues you're facing..."
              rows="3"
            ></textarea>
            <span class="demo-overlay__field-focus"></span>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="demo-overlay__submit">
            <span class="demo-overlay__submit-text">Schedule My Demo</span>
            <span class="demo-overlay__submit-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
            </span>
            <span class="demo-overlay__submit-shine"></span>
          </button>

          <!-- Privacy Notice -->
          <p class="demo-overlay__privacy">
            By submitting, you agree to our <a href="/privacy">Privacy Policy</a>.
            We'll never share your information.
          </p>

        </form>

        <!-- Success State (hidden by default) -->
        <div id="demo-success" class="demo-overlay__success" hidden>
          <div class="demo-overlay__success-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
          <h3 class="demo-overlay__success-title">You're All Set!</h3>
          <p class="demo-overlay__success-text">
            Our team will reach out within 24 hours to schedule your personalized demo.
          </p>
          <button type="button" class="demo-overlay__success-close">Back to Site</button>
        </div>

      </div>
    </div>

  </div>
</div>

<style>
  /* ==========================================================================
     DEMO REQUEST OVERLAY - Editorial Magazine Style
     ========================================================================== */

  .demo-overlay {
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: flex;
    align-items: stretch;
    background: rgba(0, 0, 0, 0.85);
    backdrop-filter: blur(8px);
    opacity: 0;
    visibility: hidden;
    /* On close: wait for content to slide out first, then fade backdrop */
    transition:
      opacity 0.3s cubic-bezier(0.16, 1, 0.3, 1) 0.3s,
      visibility 0.3s cubic-bezier(0.16, 1, 0.3, 1) 0.3s;
  }

  .demo-overlay[aria-hidden="false"] {
    opacity: 1;
    visibility: visible;
    /* On open: backdrop fades in immediately */
    transition:
      opacity 0.4s cubic-bezier(0.16, 1, 0.3, 1),
      visibility 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .demo-overlay__container {
    display: flex;
    width: 100%;
    height: 100vh;
    transform: translateX(100%);
    opacity: 0;
    /* On close: slide and fade out immediately */
    transition:
      transform 0.4s cubic-bezier(0.4, 0, 0.2, 1),
      opacity 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .demo-overlay[aria-hidden="false"] .demo-overlay__container {
    transform: translateX(0);
    opacity: 1;
    /* On open: slide in after backdrop starts fading */
    transition:
      transform 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0.1s,
      opacity 0.4s cubic-bezier(0.16, 1, 0.3, 1) 0.1s;
  }

  /* --------------------------------
     CLOSE BUTTON
     -------------------------------- */
  .demo-overlay__close {
    position: absolute;
    top: var(--space-6);
    right: var(--space-6);
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    background: #111111;
    border: 1px solid #333333;
    border-radius: var(--radius-full);
    color: white;
    cursor: pointer;
    transition:
      background 0.2s ease,
      border-color 0.2s ease,
      transform 0.2s ease;
  }

  .demo-overlay__close:hover {
    background: var(--color-primary);
    border-color: var(--color-primary);
    transform: rotate(90deg);
  }

  /* --------------------------------
     LEFT PANEL: EDITORIAL
     -------------------------------- */
  .demo-overlay__editorial {
    position: relative;
    flex: 0 0 66.666%;
    max-width: 66.666%;
    background: #000;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  /* Background Layers */
  .demo-overlay__bg {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .demo-overlay__bg-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    opacity: 0.4;
    filter: grayscale(100%);
  }

  .demo-overlay__bg-gradient {
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg,
      rgba(0,0,0,0.95) 0%,
      rgba(0,0,0,0.7) 30%,
      rgba(0,0,0,0.6) 60%,
      rgba(0,0,0,0.9) 100%
    );
  }

  /* Editorial Content */
  .demo-overlay__content {
    position: relative;
    z-index: 1;
    padding: var(--space-16) var(--space-12);
    max-width: 720px;
  }

  /* Eyebrow */
  .demo-overlay__eyebrow {
    display: inline-flex;
    align-items: center;
    gap: var(--space-3);
    font-family: var(--font-body);
    font-size: var(--text-xs);
    font-weight: var(--font-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-widest);
    color: var(--color-primary);
    margin-bottom: var(--space-6);
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.2s both;
  }

  .demo-overlay__eyebrow-line {
    width: 32px;
    height: 2px;
    background: var(--color-primary);
  }

  /* Magazine Headline */
  .demo-overlay__headline {
    font-family: var(--font-display);
    font-size: clamp(3rem, 5vw, 5rem);
    font-weight: var(--font-extrabold);
    line-height: var(--leading-none);
    letter-spacing: var(--tracking-tight);
    color: white;
    margin-bottom: var(--space-6);
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.3s both;
  }

  .demo-overlay__headline-accent {
    display: block;
    color: var(--color-primary);
    font-style: italic;
  }

  /* Subheadline */
  .demo-overlay__subhead {
    font-family: var(--font-body);
    font-size: var(--text-xl);
    line-height: var(--leading-relaxed);
    color: rgba(255, 255, 255, 0.7);
    max-width: 480px;
    margin-bottom: var(--space-10);
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.4s both;
  }

  /* Trust Indicators */
  .demo-overlay__trust {
    display: flex;
    align-items: center;
    gap: var(--space-6);
    margin-bottom: var(--space-12);
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.5s both;
  }

  .demo-overlay__trust-item {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
  }

  .demo-overlay__trust-number {
    font-family: var(--font-display);
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    color: white;
    line-height: 1;
  }

  .demo-overlay__trust-label {
    font-family: var(--font-body);
    font-size: var(--text-xs);
    color: rgba(255, 255, 255, 0.5);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
  }

  .demo-overlay__trust-divider {
    width: 1px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
  }

  /* Quote */
  .demo-overlay__quote {
    position: relative;
    padding-left: var(--space-6);
    border-left: 3px solid var(--color-primary);
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.6s both;
  }

  .demo-overlay__quote p {
    font-family: var(--font-body);
    font-size: var(--text-lg);
    font-style: italic;
    line-height: var(--leading-relaxed);
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: var(--space-2);
  }

  .demo-overlay__quote cite {
    font-family: var(--font-body);
    font-size: var(--text-sm);
    font-style: normal;
    color: rgba(255, 255, 255, 0.5);
  }

  /* --------------------------------
     RIGHT PANEL: FORM (Light Mode with Grid)
     -------------------------------- */
  .demo-overlay__form-panel {
    position: relative;
    flex: 0 0 33.333%;
    max-width: 33.333%;
    background: #FFFFFF;
    border-left: 1px solid #E5E5E5;
    display: flex;
    flex-direction: column;
    justify-content: center;
    overflow-y: auto;
  }

  /* Grid texture background */
  .demo-overlay__form-panel::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(0, 0, 0, 0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0, 0, 0, 0.04) 1px, transparent 1px),
      linear-gradient(rgba(0, 0, 0, 0.02) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0, 0, 0, 0.02) 1px, transparent 1px);
    background-size:
      60px 60px,
      60px 60px,
      15px 15px,
      15px 15px;
    mask-image: radial-gradient(
      ellipse 150% 100% at 50% 0%,
      black 0%,
      rgba(0,0,0,0.4) 30%,
      transparent 60%
    );
    -webkit-mask-image: radial-gradient(
      ellipse 150% 100% at 50% 0%,
      black 0%,
      rgba(0,0,0,0.4) 30%,
      transparent 60%
    );
    pointer-events: none;
  }

  /* Subtle radial gradient */
  .demo-overlay__form-panel::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
      ellipse 120% 80% at 50% 0%,
      rgba(0, 0, 0, 0.03) 0%,
      transparent 60%
    );
    pointer-events: none;
  }

  .demo-overlay__form-inner {
    position: relative;
    z-index: 1;
    padding: var(--space-10) var(--space-8);
  }

  /* Form Header */
  .demo-overlay__form-header {
    margin-bottom: var(--space-8);
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.4s both;
  }

  .demo-overlay__form-title {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    font-weight: var(--font-bold);
    color: #111111;
    margin-bottom: var(--space-2);
  }

  .demo-overlay__form-subtitle {
    font-family: var(--font-body);
    font-size: var(--text-sm);
    color: #666666;
  }

  /* Form Styles */
  .demo-overlay__form {
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
  }

  .demo-overlay__form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-4);
  }

  .demo-overlay__field {
    position: relative;
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) calc(0.5s + var(--field-delay, 0s)) both;
  }

  .demo-overlay__field:nth-child(1) { --field-delay: 0s; }
  .demo-overlay__field:nth-child(2) { --field-delay: 0.05s; }
  .demo-overlay__field:nth-child(3) { --field-delay: 0.1s; }
  .demo-overlay__field:nth-child(4) { --field-delay: 0.15s; }
  .demo-overlay__field:nth-child(5) { --field-delay: 0.2s; }
  .demo-overlay__field:nth-child(6) { --field-delay: 0.25s; }

  .demo-overlay__label {
    display: block;
    font-family: var(--font-body);
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
    color: #555555;
    margin-bottom: var(--space-2);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wide);
  }

  .demo-overlay__input,
  .demo-overlay__select,
  .demo-overlay__textarea {
    width: 100%;
    padding: var(--space-3) var(--space-4);
    font-family: var(--font-body);
    font-size: var(--text-base);
    color: #111111;
    background: #FFFFFF;
    border: 1px solid #E0E0E0;
    border-radius: var(--radius-md);
    transition:
      border-color 0.2s ease,
      background 0.2s ease,
      box-shadow 0.2s ease;
  }

  .demo-overlay__input::placeholder,
  .demo-overlay__textarea::placeholder {
    color: #AAAAAA;
  }

  .demo-overlay__input:focus,
  .demo-overlay__select:focus,
  .demo-overlay__textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    background: #FFFFFF;
    box-shadow: 0 0 0 3px rgba(234, 36, 43, 0.1);
  }

  /* Select Wrapper */
  .demo-overlay__select-wrapper {
    position: relative;
  }

  .demo-overlay__select {
    appearance: none;
    cursor: pointer;
    padding-right: var(--space-10);
  }

  .demo-overlay__select-icon {
    position: absolute;
    right: var(--space-3);
    top: 50%;
    transform: translateY(-50%);
    color: #888888;
    pointer-events: none;
  }

  /* Textarea */
  .demo-overlay__textarea {
    resize: none;
    min-height: 80px;
  }

  /* Submit Button */
  .demo-overlay__submit {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-3);
    width: 100%;
    padding: var(--space-4) var(--space-6);
    margin-top: var(--space-4);
    font-family: var(--font-display);
    font-size: var(--text-base);
    font-weight: var(--font-semibold);
    color: white;
    background: var(--color-primary);
    border: none;
    border-radius: var(--radius-full);
    cursor: pointer;
    overflow: hidden;
    transition:
      background 0.2s ease,
      transform 0.2s ease,
      box-shadow 0.2s ease;
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.8s both;
  }

  .demo-overlay__submit:hover {
    background: var(--color-primary-hover);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(234, 36, 43, 0.4);
  }

  .demo-overlay__submit:active {
    transform: translateY(0);
  }

  .demo-overlay__submit-icon {
    display: flex;
    transition: transform 0.3s ease;
  }

  .demo-overlay__submit:hover .demo-overlay__submit-icon {
    transform: translateX(4px);
  }

  .demo-overlay__submit-shine {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      120deg,
      transparent 30%,
      rgba(255, 255, 255, 0.2) 50%,
      transparent 70%
    );
    transform: translateX(-100%);
    transition: transform 0.6s ease;
  }

  .demo-overlay__submit:hover .demo-overlay__submit-shine {
    transform: translateX(100%);
  }

  /* Privacy Notice */
  .demo-overlay__privacy {
    font-family: var(--font-body);
    font-size: var(--text-xs);
    color: #999999;
    text-align: center;
    margin-top: var(--space-4);
    animation: slideIn 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.9s both;
  }

  .demo-overlay__privacy a {
    color: #666666;
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: color 0.2s ease;
  }

  .demo-overlay__privacy a:hover {
    color: var(--color-primary);
  }

  /* --------------------------------
     SUCCESS STATE (Light Mode)
     -------------------------------- */
  .demo-overlay__success {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: var(--space-8);
    animation: scaleIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  }

  .demo-overlay__success[hidden] {
    display: none;
  }

  .demo-overlay__success-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 80px;
    height: 80px;
    margin-bottom: var(--space-6);
    background: rgba(34, 197, 94, 0.1);
    border: 2px solid var(--color-success);
    border-radius: var(--radius-full);
    color: var(--color-success);
  }

  .demo-overlay__success-title {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    font-weight: var(--font-bold);
    color: #111111;
    margin-bottom: var(--space-3);
  }

  .demo-overlay__success-text {
    font-family: var(--font-body);
    font-size: var(--text-base);
    color: #666666;
    margin-bottom: var(--space-8);
    max-width: 280px;
  }

  .demo-overlay__success-close {
    padding: var(--space-3) var(--space-8);
    font-family: var(--font-display);
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    color: #111111;
    background: transparent;
    border: 1px solid #E0E0E0;
    border-radius: var(--radius-full);
    cursor: pointer;
    transition:
      background 0.2s ease,
      border-color 0.2s ease;
  }

  .demo-overlay__success-close:hover {
    background: #F5F5F5;
    border-color: #CCCCCC;
  }

  /* --------------------------------
     ANIMATIONS
     -------------------------------- */
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* --------------------------------
     RESPONSIVE
     -------------------------------- */
  @media (max-width: 1200px) {
    .demo-overlay__editorial {
      flex: 0 0 55%;
      max-width: 55%;
    }

    .demo-overlay__form-panel {
      flex: 0 0 45%;
      max-width: 45%;
    }

    .demo-overlay__content {
      padding: var(--space-12) var(--space-8);
    }

    .demo-overlay__headline {
      font-size: clamp(2.5rem, 4vw, 4rem);
    }
  }

  @media (max-width: 900px) {
    .demo-overlay__container {
      flex-direction: column;
      overflow-y: auto;
    }

    .demo-overlay__editorial {
      flex: 0 0 auto;
      max-width: 100%;
      min-height: 45vh;
    }

    .demo-overlay__form-panel {
      flex: 1;
      max-width: 100%;
      border-left: none;
      border-top: 1px solid rgba(255, 255, 255, 0.08);
    }

    .demo-overlay__content {
      padding: var(--space-8) var(--space-6);
    }

    .demo-overlay__trust {
      flex-wrap: wrap;
      gap: var(--space-4);
    }

    .demo-overlay__trust-divider {
      display: none;
    }

    .demo-overlay__quote {
      display: none;
    }

    .demo-overlay__close {
      top: var(--space-4);
      right: var(--space-4);
      width: 40px;
      height: 40px;
    }
  }

  @media (max-width: 600px) {
    .demo-overlay__form-row {
      grid-template-columns: 1fr;
    }

    .demo-overlay__form-inner {
      padding: var(--space-6);
    }

    .demo-overlay__headline {
      font-size: clamp(2rem, 8vw, 3rem);
    }

    .demo-overlay__editorial {
      min-height: 35vh;
    }
  }
</style>

<script>
  // Demo Overlay Controller
  class DemoOverlay {
    private overlay: HTMLElement;
    private form: HTMLFormElement;
    private successEl: HTMLElement;
    private closeBtn: HTMLButtonElement;
    private successCloseBtn: HTMLButtonElement;

    constructor() {
      this.overlay = document.getElementById('demo-overlay')!;
      this.form = document.getElementById('demo-request-form') as HTMLFormElement;
      this.successEl = document.getElementById('demo-success')!;
      this.closeBtn = this.overlay.querySelector('.demo-overlay__close')!;
      this.successCloseBtn = this.overlay.querySelector('.demo-overlay__success-close')!;

      this.bindEvents();
    }

    bindEvents() {
      // Close button
      this.closeBtn.addEventListener('click', () => this.close());
      this.successCloseBtn.addEventListener('click', () => this.close());

      // Click outside to close (on backdrop)
      this.overlay.addEventListener('click', (e) => {
        if (e.target === this.overlay) {
          this.close();
        }
      });

      // ESC key to close
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && this.overlay.getAttribute('aria-hidden') === 'false') {
          this.close();
        }
      });

      // Form submission
      this.form.addEventListener('submit', (e) => this.handleSubmit(e));

      // Listen for open events
      document.addEventListener('open-demo-overlay', () => this.open());
    }

    open() {
      this.overlay.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';

      // Focus first input after animation
      setTimeout(() => {
        const firstInput = this.form.querySelector('input') as HTMLInputElement;
        firstInput?.focus();
      }, 600);
    }

    close() {
      this.overlay.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';

      // Reset form state after close animation
      setTimeout(() => {
        this.form.reset();
        this.form.hidden = false;
        this.successEl.hidden = true;
      }, 400);
    }

    async handleSubmit(e: Event) {
      e.preventDefault();

      const submitBtn = this.form.querySelector('.demo-overlay__submit') as HTMLButtonElement;
      const originalText = submitBtn.querySelector('.demo-overlay__submit-text')!.textContent;

      // Show loading state
      submitBtn.disabled = true;
      submitBtn.querySelector('.demo-overlay__submit-text')!.textContent = 'Sending...';

      // Simulate API call (replace with actual endpoint)
      await new Promise(resolve => setTimeout(resolve, 1500));

      // Show success state
      this.form.hidden = true;
      this.successEl.hidden = false;

      // Reset button state
      submitBtn.disabled = false;
      submitBtn.querySelector('.demo-overlay__submit-text')!.textContent = originalText;
    }
  }

  // Initialize when DOM is ready
  document.addEventListener('DOMContentLoaded', () => {
    new DemoOverlay();
  });

  // Also initialize on Astro page transitions
  document.addEventListener('astro:page-load', () => {
    new DemoOverlay();
  });
</script>

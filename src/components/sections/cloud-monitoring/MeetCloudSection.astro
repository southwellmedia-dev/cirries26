---
/**
 * MeetCloudSection - "One View. Every Cloud. Complete Clarity."
 *
 * Unified hybrid/multi-cloud intro section featuring:
 * - Central DART-AI command hub visualization
 * - All cloud environments connected (AWS, Azure, GCP, VMware, On-Prem)
 * - Focus on "single source of truth" for fragmented environments
 */
import Container from "../../ui/Container.astro";
import Button from "../../ui/Button.astro";
import DartLogoLight from "../../../assets/logos/dart-lightmode.svg";

interface Props {
  eyebrow?: string;
  title?: string;
  highlightText?: string;
  paragraphs?: string[];
  primaryCta?: { label: string; href: string };
  secondaryCta?: { label: string; href: string };
}

const {
  eyebrow = "Unified Cloud Observability",
  title = "One View. Every Cloud.",
  highlightText = "Complete Clarity.",
  paragraphs = [
    "Your enterprise runs on a strategic mix of AWS, Azure, Google Cloud, and your own data centers. But when performance degrades, the <strong>war room assembles</strong> and the finger-pointing begins. Each team sees a different dashboard, a different dataset, and a different version of reality.",
    "DART-AI provides the one thing that can end it: a <strong>single, indisputable source of truth</strong>. We analyze every packet in real-time to generate <strong>DART IQ</strong>â€”a rich, cost-efficient metadata layer that gives you forensic depth without the crippling expense.",
  ],
  primaryCta = {
    label: "Unite Your Cloud Estate",
    href: "/contact",
  },
  secondaryCta = { label: "View All Solutions", href: "/solutions" },
} = Astro.props;

// Cloud environment nodes for visualization
// Using Font Awesome brand icons (fa-brands) where available
const cloudNodes = [
  { type: "aws", label: "AWS", angle: -50, distance: 155, color: "#FF9900", faIcon: "fa-brands fa-aws" },
  { type: "azure", label: "Azure", angle: 0, distance: 165, color: "#0078D4", faIcon: "fa-brands fa-microsoft" },
  { type: "gcp", label: "GCP", angle: 50, distance: 155, color: "#4285F4", faIcon: "fa-brands fa-google" },
  { type: "vmware", label: "VMware", angle: 130, distance: 155, color: "#607078", faIcon: "fa-solid fa-server" },
  { type: "onprem", label: "On-Prem", angle: 180, distance: 165, color: "#6B7280", faIcon: "fa-solid fa-building" },
  { type: "edge", label: "Edge", angle: -130, distance: 155, color: "#10B981", faIcon: "fa-solid fa-microchip" },
];
---

<section class="meet-cloud-section" data-theme="light">
  <!-- Ambient background -->
  <div class="cloud-bg">
    <div class="cloud-gradient"></div>
    <div class="cloud-grid"></div>
    <div class="cloud-pattern"></div>
  </div>

  <Container size="xl">
    <div class="meet-cloud">
      <!-- Left: Content -->
      <div class="meet-cloud__content">
        <span class="meet-cloud__eyebrow">{eyebrow}</span>

        <h2 class="meet-cloud__title">
          {title}
          <span>{highlightText}</span>
        </h2>

        {paragraphs.map((text) => <p class="meet-cloud__text" set:html={text} />)}

        <div class="meet-cloud__actions">
          <Button href={primaryCta.href} variant="primary">
            {primaryCta.label}
          </Button>
          <Button href={secondaryCta.href} variant="outline-dark">
            {secondaryCta.label}
          </Button>
        </div>
      </div>

      <!-- Right: Cloud Visualization -->
      <div class="cloud-network" id="cloud-network">
        <!-- SVG for connection lines -->
        <svg class="cloud-connections" viewBox="0 0 400 400" id="cloud-connections-svg">
          <defs>
            <linearGradient id="cloud-flow-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color: rgba(234, 36, 43, 0.1)"></stop>
              <stop offset="50%" style="stop-color: rgba(234, 36, 43, 0.5)"></stop>
              <stop offset="100%" style="stop-color: rgba(234, 36, 43, 0.1)"></stop>
            </linearGradient>
          </defs>
          <g id="cloud-mesh-lines"></g>
          <g id="cloud-connection-lines"></g>
        </svg>

        <!-- Central Hub - DART-AI Command Center -->
        <div class="cloud-hub" id="cloud-hub">
          <div class="hub-pulse"></div>
          <div class="hub-ring hub-ring-1"></div>
          <div class="hub-ring hub-ring-2"></div>
          <div class="hub-ring hub-ring-3"></div>
          <div class="hub-core">
            <img src={DartLogoLight.src} alt="DART-AI" />
          </div>
          <div class="hub-label">Single Source of Truth</div>
        </div>

        <!-- Cloud Environment Nodes -->
        {cloudNodes.map((node, index) => (
          <div
            class={`cloud-node cloud-node--${node.type}`}
            data-angle={node.angle}
            data-distance={node.distance}
            data-index={index}
            data-color={node.color}
            style={`--node-delay: ${index * 0.12}s; --node-color: ${node.color}`}
          >
            <div class="node-cloud">
              <!-- Cloud shape SVG background -->
              <svg class="cloud-shape" viewBox="0 0 64 44" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M52 44H12C5.373 44 0 38.627 0 32c0-5.565 3.79-10.242 8.93-11.6C9.14 9.847 17.837 2 28.5 2c8.348 0 15.57 4.918 18.895 12.01C48.24 14.14 49.107 14 50 14c7.732 0 14 6.268 14 14s-6.268 16-14 16h-2z" fill="currentColor"/>
              </svg>
              <!-- Font Awesome brand/solid icon -->
              <i class={`${node.faIcon} node-fa-icon`}></i>
            </div>
            <span class="node-label">{node.label}</span>
          </div>
        ))}

        <!-- Data flow packets container -->
        <div class="data-flows" id="cloud-data-flows"></div>

        <!-- Unified visibility ring -->
        <div class="visibility-ring"></div>
      </div>
    </div>
  </Container>
</section>

<style>
  .meet-cloud-section {
    position: relative;
    padding: var(--space-20) 0;
    background: #ffffff;
    overflow: hidden;
  }

  .cloud-bg {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .cloud-gradient {
    position: absolute;
    inset: 0;
    background:
      radial-gradient(ellipse 100% 80% at 75% 40%, rgba(234, 36, 43, 0.03) 0%, transparent 50%),
      radial-gradient(ellipse 70% 50% at 20% 70%, rgba(0, 120, 212, 0.03) 0%, transparent 45%),
      radial-gradient(ellipse 50% 40% at 85% 85%, rgba(66, 133, 244, 0.02) 0%, transparent 40%),
      linear-gradient(180deg, #ffffff 0%, #f8f9fa 50%, #f5f5f7 100%);
  }

  .cloud-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(0, 0, 0, 0.015) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0, 0, 0, 0.015) 1px, transparent 1px);
    background-size: 40px 40px;
    mask-image: radial-gradient(ellipse 85% 75% at 65% 50%, black 15%, transparent 70%);
    -webkit-mask-image: radial-gradient(ellipse 85% 75% at 65% 50%, black 15%, transparent 70%);
  }

  .cloud-pattern {
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.015;
    mix-blend-mode: multiply;
  }

  /* Content Layout */
  .meet-cloud {
    position: relative;
    z-index: 1;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-12);
    align-items: center;
  }

  .meet-cloud__eyebrow {
    display: inline-block;
    margin-bottom: var(--space-4);
    font-family: var(--font-display);
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--color-primary);
  }

  .meet-cloud__title {
    font-family: var(--font-display);
    font-size: clamp(1.75rem, 3.5vw, 2.75rem);
    font-weight: var(--font-bold);
    line-height: 1.15;
    letter-spacing: var(--tracking-tight);
    color: #111111;
    margin-bottom: var(--space-6);
  }

  .meet-cloud__title span {
    display: block;
    color: var(--color-primary);
  }

  .meet-cloud__text {
    font-family: var(--font-body);
    font-size: var(--text-base);
    line-height: var(--leading-relaxed);
    color: #555555;
    margin-bottom: var(--space-4);
  }

  .meet-cloud__text :global(strong) {
    color: #111111;
    font-weight: var(--font-semibold);
  }

  .meet-cloud__actions {
    display: flex;
    gap: var(--space-4);
    margin-top: var(--space-8);
  }

  /* Cloud Network Visualization */
  .cloud-network {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    max-width: 500px;
    margin: 0 auto;
  }

  .cloud-connections {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  /* Central Hub */
  .cloud-hub {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 130px;
    height: 130px;
    z-index: 10;
  }

  .hub-pulse {
    position: absolute;
    inset: -25px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(234, 36, 43, 0.12) 0%, transparent 70%);
    animation: hubPulse 3s ease-in-out infinite;
  }

  @keyframes hubPulse {
    0%, 100% { transform: scale(1); opacity: 0.6; }
    50% { transform: scale(1.2); opacity: 0.9; }
  }

  .hub-ring {
    position: absolute;
    border-radius: 50%;
    border: 1px solid rgba(234, 36, 43, 0.2);
  }

  .hub-ring-1 {
    inset: -12px;
    animation: ringRotate 25s linear infinite;
    border-style: dashed;
    border-color: rgba(234, 36, 43, 0.15);
  }

  .hub-ring-2 {
    inset: -28px;
    animation: ringRotate 35s linear infinite reverse;
    border-style: dotted;
    border-color: rgba(234, 36, 43, 0.1);
  }

  .hub-ring-3 {
    inset: -48px;
    animation: ringRotate 50s linear infinite;
    border-style: dashed;
    border-width: 1px;
    border-color: rgba(234, 36, 43, 0.06);
  }

  @keyframes ringRotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .hub-core {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 50%;
    border: 1px solid rgba(0, 0, 0, 0.06);
    box-shadow:
      0 12px 40px rgba(0, 0, 0, 0.1),
      0 0 0 1px rgba(255, 255, 255, 0.8) inset,
      0 0 60px rgba(234, 36, 43, 0.05);
    z-index: 12;
  }

  .hub-core img {
    width: 60%;
    height: auto;
  }

  .hub-label {
    position: absolute;
    bottom: -32px;
    left: 50%;
    transform: translateX(-50%);
    font-family: var(--font-mono);
    font-size: 0.55rem;
    font-weight: var(--font-medium);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--color-primary);
    white-space: nowrap;
    padding: 4px 10px;
    background: rgba(234, 36, 43, 0.06);
    border-radius: 4px;
  }

  /* Visibility Ring */
  .visibility-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 85%;
    height: 85%;
    transform: translate(-50%, -50%);
    border: 1px dashed rgba(234, 36, 43, 0.1);
    border-radius: 50%;
    pointer-events: none;
    z-index: 0;
  }

  /* Cloud Nodes */
  .cloud-node {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    transform: translate(-50%, -50%);
    opacity: 0;
    animation: nodeAppear 0.5s ease forwards;
    animation-delay: var(--node-delay);
    z-index: 8;
  }

  @keyframes nodeAppear {
    from { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
    to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  }

  /* Cloud-shaped node container */
  .node-cloud {
    position: relative;
    width: 64px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  .cloud-shape {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    color: #ffffff;
    filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.08)) drop-shadow(0 4px 16px rgba(0, 0, 0, 0.04));
    transition: all 0.3s ease;
  }

  /* Subtle border effect via stroke */
  .cloud-shape path {
    stroke: rgba(0, 0, 0, 0.06);
    stroke-width: 1;
  }

  /* Font Awesome icon inside cloud */
  .node-fa-icon {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 2;
    font-size: 1rem;
    color: var(--node-color);
    transition: all 0.3s ease;
  }

  .cloud-node:hover .node-cloud {
    transform: scale(1.08) translateY(-2px);
  }

  .cloud-node:hover .cloud-shape {
    filter: drop-shadow(0 4px 16px color-mix(in srgb, var(--node-color) 25%, transparent))
            drop-shadow(0 8px 24px rgba(0, 0, 0, 0.08));
  }

  .cloud-node:hover .cloud-shape path {
    stroke: var(--node-color);
    stroke-width: 1.5;
  }

  .cloud-node:hover .node-fa-icon {
    transform: translate(-50%, -50%) scale(1.1);
  }

  .node-label {
    font-family: var(--font-mono);
    font-size: 0.6rem;
    font-weight: var(--font-medium);
    text-transform: uppercase;
    letter-spacing: 0.03em;
    color: #6b7280;
    white-space: nowrap;
  }

  
  /* Data Flows */
  .data-flows {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 6;
  }

  :global(.cloud-data-flow) {
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    opacity: 0;
    z-index: 9;
  }

  :global(.cloud-data-flow--healthy) {
    background: #22c55e;
    box-shadow: 0 0 12px rgba(34, 197, 94, 0.7);
  }

  :global(.cloud-data-flow--warning) {
    background: #f59e0b;
    box-shadow: 0 0 12px rgba(245, 158, 11, 0.7);
  }

  :global(.cloud-data-flow--critical) {
    background: #ef4444;
    box-shadow: 0 0 14px rgba(239, 68, 68, 0.8);
  }

  :global(.cloud-connection-line) {
    stroke: rgba(234, 36, 43, 0.12);
    stroke-width: 1.5;
    fill: none;
    stroke-dasharray: 6 4;
    animation: dashFlow 25s linear infinite;
  }

  :global(.cloud-mesh-line) {
    stroke: rgba(0, 0, 0, 0.03);
    stroke-width: 1;
    fill: none;
  }

  @keyframes dashFlow {
    to { stroke-dashoffset: -120; }
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .meet-cloud {
      grid-template-columns: 1fr;
      gap: var(--space-12);
    }

    .cloud-network {
      max-width: 420px;
    }
  }

  @media (max-width: 768px) {
    .meet-cloud-section {
      padding: var(--space-12) 0;
    }

    .meet-cloud__title {
      font-size: var(--text-2xl);
    }

    .meet-cloud__actions {
      flex-direction: column;
    }

    .cloud-network {
      max-width: 340px;
    }

    .cloud-hub {
      width: 100px;
      height: 100px;
    }

    .hub-ring-1 { inset: -10px; }
    .hub-ring-2 { inset: -22px; }
    .hub-ring-3 { inset: -38px; }

    .hub-label {
      font-size: 0.5rem;
      bottom: -28px;
    }

    .node-cloud {
      width: 52px;
      height: 40px;
    }

    .node-fa-icon {
      font-size: 0.85rem;
    }

    .node-label {
      display: none;
    }
  }
</style>

<script>
  import "../../../scripts/cloud-network.ts";
</script>

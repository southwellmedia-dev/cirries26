---
/**
 * Mobile ProblemSection - "Flying Blind in Your Network"
 *
 * Dark, tension-filled section showing fragmented mobile network visibility:
 * - Network silos dashboard (left)
 * - Pain point cards (right)
 */
import Container from "../../ui/Container.astro";

interface NetworkSilo {
  domain: string;
  faIcon: string;
  status: "limited" | "partial" | "blind";
  issues: string[];
  color: string;
}

interface PainPoint {
  faIcon: string;
  title: string;
  description: string;
}

interface Props {
  sectionTitle?: string;
  contextParagraph?: string;
  networkSilos?: NetworkSilo[];
  painPoints?: PainPoint[];
  bridgeStatement?: string;
  bridgeEmphasis?: string;
}

const {
  sectionTitle = "Flying Blind in Your Network",
  contextParagraph = "Your RAN team checks their vendor dashboards. Your core team monitors their own metrics. Your transport team sifts through SNMP data. Each team has a different tool, a different dataset, and a different theory—leading to guesswork, finger-pointing, and hours wasted in a 'war room.'",
  networkSilos = [
    {
      domain: "RAN",
      faIcon: "fa-solid fa-tower-cell",
      status: "partial",
      issues: ["Vendor metrics only", "No packet visibility"],
      color: "#8B5CF6",
    },
    {
      domain: "Core",
      faIcon: "fa-solid fa-server",
      status: "limited",
      issues: ["Flow logs only", "Missing context"],
      color: "#3B82F6",
    },
    {
      domain: "Transport",
      faIcon: "fa-solid fa-network-wired",
      status: "partial",
      issues: ["SNMP metrics", "No correlation"],
      color: "#10B981",
    },
    {
      domain: "Apps",
      faIcon: "fa-solid fa-layer-group",
      status: "blind",
      issues: ["APM gaps", "No network view"],
      color: "#F59E0B",
    },
  ],
  painPoints = [
    {
      faIcon: "fa-solid fa-eye-slash",
      title: "Logs Hide the 'Why'",
      description: "Logs, metrics, and flow records are all summaries. They tell you that something happened, but they often hide the why. Only packets reveal the ground truth.",
    },
    {
      faIcon: "fa-solid fa-users-slash",
      title: "The Blame Game",
      description: "When an app is slow, is it the RAN, the core, or transport? Siloed tools can't correlate across layers—so your team wastes hours hunting for answers.",
    },
    {
      faIcon: "fa-solid fa-shield-halved",
      title: "Hidden Threats",
      description: "Sophisticated security threats hide in the subtle anomalies—lateral movement, data exfiltration. Without packet-level visibility, they remain invisible.",
    },
    {
      faIcon: "fa-solid fa-clock",
      title: "Subscriber Impact",
      description: "Every minute of guesswork is a minute of poor experience for thousands of users—degrading service while you search for root cause.",
    },
  ],
  bridgeStatement = "You need a platform that sees everything—",
  bridgeEmphasis = "not just what each vendor chooses to show you.",
} = Astro.props;

const statusConfig: Record<string, { label: string; color: string }> = {
  limited: { label: "Limited", color: "#f59e0b" },
  partial: { label: "Partial", color: "#f59e0b" },
  blind: { label: "Blind Spot", color: "#ef4444" },
};
---

<section class="problem-section" data-theme="dark">
  <div class="problem-bg">
    <div class="problem-gradient"></div>
    <div class="problem-grid"></div>
    <div class="problem-noise"></div>
    <div class="silo-glow silo-glow--1"></div>
    <div class="silo-glow silo-glow--2"></div>
  </div>

  <Container size="xl">
    <div class="problem-content">
      <!-- Header -->
      <header class="problem-header">
        <span class="problem-eyebrow">The Challenge</span>
        <h2 class="problem-title">{sectionTitle}</h2>
        <p class="problem-context">{contextParagraph}</p>
      </header>

      <!-- Two Column Grid -->
      <div class="two-col">
        <!-- Left: Network Silos Dashboard -->
        <div class="col-silos">
          <div class="silo-dashboard">
            <div class="dashboard-chrome">
              <div class="chrome-dots">
                <span class="dot dot--red"></span>
                <span class="dot dot--yellow"></span>
                <span class="dot dot--green"></span>
              </div>
              <span class="chrome-title">Network Visibility Status</span>
              <span class="chrome-warning">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path>
                  <line x1="12" y1="9" x2="12" y2="13"></line>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                Fragmented
              </span>
            </div>

            <div class="dashboard-body">
              <div class="silo-grid">
                {networkSilos.map((silo, index) => (
                  <div
                    class={`silo-card silo-card--${silo.status}`}
                    style={`--silo-color: ${silo.color}; --silo-delay: ${index * 0.1}s`}
                  >
                    <div class="silo-header">
                      <div class="silo-icon" style={`background: ${silo.color}15; border-color: ${silo.color}30; color: ${silo.color}`}>
                        <i class={silo.faIcon}></i>
                      </div>
                      <div class="silo-info">
                        <span class="silo-domain">{silo.domain}</span>
                        <span
                          class="silo-status"
                          style={`color: ${statusConfig[silo.status].color}; background: ${statusConfig[silo.status].color}15`}
                        >
                          {statusConfig[silo.status].label}
                        </span>
                      </div>
                    </div>
                    <div class="silo-issues">
                      {silo.issues.map((issue) => (
                        <span class="silo-issue">
                          <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                          </svg>
                          {issue}
                        </span>
                      ))}
                    </div>
                    <div class="silo-blindspot"></div>
                  </div>
                ))}
              </div>

              <!-- Unified View Missing Indicator -->
              <div class="unified-missing">
                <div class="missing-icon">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>
                  </svg>
                </div>
                <div class="missing-content">
                  <span class="missing-label">Unified Cross-Domain View</span>
                  <span class="missing-status">NOT AVAILABLE</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right: Pain Cards -->
        <div class="col-pain">
          <div class="pain-cards">
            {painPoints.map((point, index) => (
              <article class="pain-card" style={`--delay: ${index * 0.12}s`}>
                <div class="pain-bar"></div>
                <div class="pain-icon">
                  <i class={point.faIcon}></i>
                </div>
                <div class="pain-content">
                  <h3 class="pain-title">{point.title}</h3>
                  <p class="pain-desc">{point.description}</p>
                </div>
              </article>
            ))}
          </div>
        </div>
      </div>

      <!-- Bridge -->
      <div class="bridge">
        <p class="bridge-text">
          {bridgeStatement}
          <strong class="bridge-emphasis">{bridgeEmphasis}</strong>
        </p>
      </div>
    </div>
  </Container>
</section>

<style>
  .problem-section {
    position: relative;
    padding: var(--space-20) 0 var(--space-16);
    background: var(--color-bg-dark);
    overflow: hidden;
  }

  .problem-bg {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .problem-gradient {
    position: absolute;
    inset: 0;
    background:
      radial-gradient(
        ellipse 50% 40% at 20% 25%,
        var(--color-primary-6) 0%,
        transparent 50%
      ),
      radial-gradient(
        ellipse 50% 40% at 80% 30%,
        var(--color-primary-5) 0%,
        transparent 50%
      ),
      radial-gradient(
        ellipse 40% 30% at 50% 70%,
        var(--color-primary-4) 0%,
        transparent 50%
      ),
      linear-gradient(180deg, var(--color-bg-dark) 0%, #0a0a0c 100%);
  }

  .problem-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(var(--color-white-1) 1px, transparent 1px),
      linear-gradient(90deg, var(--color-white-1) 1px, transparent 1px);
    background-size: 50px 50px;
    mask-image: radial-gradient(
      ellipse 75% 55% at 50% 40%,
      black 0%,
      transparent 70%
    );
  }

  .problem-noise {
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    opacity: 0.02;
    mix-blend-mode: overlay;
  }

  .silo-glow {
    position: absolute;
    width: 350px;
    height: 350px;
    border-radius: 50%;
    animation: siloGlow 5s ease-in-out infinite;
  }

  .silo-glow--1 {
    top: 15%;
    left: 10%;
    background: radial-gradient(circle, var(--color-primary-8) 0%, transparent 60%);
  }

  .silo-glow--2 {
    bottom: 20%;
    right: 15%;
    background: radial-gradient(circle, var(--color-primary-6) 0%, transparent 60%);
    animation-delay: 2.5s;
  }

  @keyframes siloGlow {
    0%, 100% { opacity: 0.5; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.1); }
  }

  .problem-content {
    position: relative;
    z-index: 1;
  }

  /* Header */
  .problem-header {
    text-align: center;
    margin-bottom: var(--space-12);
    max-width: 720px;
    margin-left: auto;
    margin-right: auto;
  }

  .problem-eyebrow {
    display: inline-block;
    padding: var(--space-1-5) var(--space-4);
    margin-bottom: var(--space-4);
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    font-weight: var(--font-medium);
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: #f59e0b;
    background: var(--color-warning-muted);
    border: 1px solid var(--color-warning-subtle);
    border-radius: var(--radius-full);
  }

  .problem-title {
    font-family: var(--font-display);
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    font-weight: var(--font-bold);
    line-height: 1.15;
    letter-spacing: -0.02em;
    color: var(--color-text-primary);
    margin-bottom: var(--space-5);
  }

  .problem-context {
    font-family: var(--font-body);
    font-size: var(--text-base);
    line-height: 1.7;
    color: var(--color-white-55);
  }

  /* Two Column Grid */
  .two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-8);
    align-items: stretch;
    margin-bottom: var(--space-12);
  }

  /* Silo Dashboard */
  .col-silos {
    display: flex;
  }

  .silo-dashboard {
    width: 100%;
    background: #0b0b0d;
    border: 1px solid #1c1c20;
    border-radius: 12px;
    overflow: hidden;
    box-shadow:
      0 20px 50px var(--color-black-50),
      0 0 80px var(--color-primary-3);
  }

  .dashboard-chrome {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2-5) var(--space-3-5);
    background: #131315;
    border-bottom: 1px solid #1c1c20;
  }

  .chrome-dots {
    display: flex;
    gap: 5px;
  }

  .dot {
    width: 9px;
    height: 9px;
    border-radius: 50%;
  }

  .dot--red { background: #ff5f57; }
  .dot--yellow { background: #ffbd2e; }
  .dot--green { background: #28ca41; }

  .chrome-title {
    flex: 1;
    text-align: center;
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    color: var(--color-white-35);
  }

  .chrome-warning {
    display: flex;
    align-items: center;
    gap: var(--space-1-5);
    padding: var(--space-1) var(--space-2);
    background: var(--color-warning-muted);
    border: 1px solid var(--color-warning-subtle);
    border-radius: var(--radius-sm);
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    text-transform: uppercase;
    color: #f59e0b;
  }

  .dashboard-body {
    padding: var(--space-3-5);
  }

  .silo-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-2-5);
    margin-bottom: var(--space-3);
  }

  .silo-card {
    padding: var(--space-3);
    background: #0e0e10;
    border: 1px solid #1a1a1e;
    border-radius: var(--radius-md);
    position: relative;
    overflow: hidden;
    opacity: 0;
    transform: translateY(8px);
    animation: siloFadeIn 0.4s ease forwards;
    animation-delay: var(--silo-delay);
  }

  @keyframes siloFadeIn {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .silo-header {
    display: flex;
    align-items: center;
    gap: var(--space-2-5);
    margin-bottom: var(--space-2-5);
  }

  .silo-icon {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-md);
    border: 1px solid;
    font-size: 0.95rem;
  }

  .silo-info {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
  }

  .silo-domain {
    font-family: var(--font-display);
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    color: var(--color-text-primary);
  }

  .silo-status {
    font-family: var(--font-mono);
    font-size: var(--text-3xs);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: var(--space-0-5) var(--space-1-5);
    border-radius: var(--radius-sm);
    width: fit-content;
  }

  .silo-issues {
    display: flex;
    flex-direction: column;
    gap: var(--space-1-5);
  }

  .silo-issue {
    display: flex;
    align-items: center;
    gap: var(--space-1-5);
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    color: var(--color-white-40);
  }

  .silo-issue svg {
    color: var(--color-primary-60);
    flex-shrink: 0;
  }

  .silo-blindspot {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--color-primary-40), transparent);
    opacity: 0.6;
  }

  .silo-card--blind {
    border-color: var(--color-primary-20);
    background: var(--color-primary-3);
  }

  .silo-card--blind .silo-blindspot {
    opacity: 1;
    background: linear-gradient(90deg, transparent, #ef4444, transparent);
  }

  /* Unified Missing */
  .unified-missing {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-3) var(--space-3-5);
    background: var(--color-primary-5);
    border: 1px dashed var(--color-primary-25);
    border-radius: var(--radius-md);
  }

  .missing-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-primary-10);
    border-radius: var(--radius-md);
    color: #ef4444;
  }

  .missing-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-1);
  }

  .missing-label {
    font-family: var(--font-body);
    font-size: var(--text-sm);
    color: var(--color-white-70);
  }

  .missing-status {
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    font-weight: var(--font-bold);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: #ef4444;
  }

  /* Pain Cards */
  .col-pain {
    display: flex;
    flex-direction: column;
  }

  .pain-cards {
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    flex: 1;
  }

  .pain-card {
    display: flex;
    align-items: center;
    gap: var(--space-3-5);
    padding: var(--space-4) var(--space-4-5);
    background: #0b0b0d;
    border: 1px solid #1c1c20;
    border-radius: var(--radius-lg);
    position: relative;
    overflow: hidden;
    flex: 1;
    opacity: 0;
    transform: translateY(12px);
    animation: fadeUp 0.4s ease forwards;
    animation-delay: var(--delay);
    transition: border-color 0.25s ease, box-shadow 0.25s ease;
  }

  .pain-card:hover {
    border-color: var(--color-warning-subtle);
    box-shadow: 0 6px 24px var(--color-black-35);
  }

  @keyframes fadeUp {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .pain-bar {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, #f59e0b, transparent);
    opacity: 0.35;
  }

  .pain-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    flex-shrink: 0;
    background: var(--color-warning-muted);
    border: 1px solid var(--color-warning-muted);
    border-radius: var(--radius-lg);
    color: #f59e0b;
    font-size: 1.1rem;
  }

  .pain-content {
    flex: 1;
    min-width: 0;
  }

  .pain-title {
    font-family: var(--font-display);
    font-size: 1.05rem;
    font-weight: var(--font-semibold);
    color: var(--color-text-primary);
    margin-bottom: var(--space-1-5);
  }

  .pain-desc {
    font-family: var(--font-body);
    font-size: 0.9rem;
    line-height: 1.55;
    color: var(--color-white-50);
    margin: 0;
  }

  /* Bridge */
  .bridge {
    max-width: 700px;
    margin: 0 auto;
    text-align: center;
    padding-top: var(--space-4);
  }

  .bridge-text {
    font-family: var(--font-body);
    font-size: var(--text-lg);
    line-height: 1.6;
    color: var(--color-white-55);
    margin: 0;
  }

  .bridge-emphasis {
    font-weight: var(--font-bold);
    color: var(--color-text-primary);
  }

  /* Responsive */
  @media (max-width: 900px) {
    .two-col {
      grid-template-columns: 1fr;
      gap: var(--space-10);
    }
  }

  @media (max-width: 480px) {
    .problem-section {
      padding: var(--space-14) 0 var(--space-12);
    }

    .silo-grid {
      grid-template-columns: 1fr;
    }

    .pain-card {
      padding: var(--space-3-5) var(--space-4);
    }

    .pain-icon {
      width: 38px;
      height: 38px;
    }
  }
</style>

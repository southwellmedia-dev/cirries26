---
/**
 * MeetMobileSection - "The Single Source of Truth for Your Mobile Network"
 *
 * Mobile network observability intro section featuring:
 * - Central DART-AI command hub visualization
 * - Mobile network components (RAN, Core, Edge, Transport)
 * - Focus on packet-level visibility and unified truth
 */
import Container from "../../ui/Container.astro";
import Button from "../../ui/Button.astro";
import DartLogoLight from "../../../assets/logos/dart-lightmode.svg";

interface Props {
  eyebrow?: string;
  title?: string;
  highlightText?: string;
  paragraphs?: string[];
  primaryCta?: { label: string; href: string };
  secondaryCta?: { label: string; href: string };
}

const {
  eyebrow = "Mobile Network Observability",
  title = "The Single Source of Truth",
  highlightText = "For Your Entire Network.",
  paragraphs = [
    "In today's distributed enterprise, your most critical business processes run on a network you can't fully see. When a cloud application slows down or a user complains, the <strong>search for answers begins</strong>. Your cloud team checks their dashboards. Your network team looks at flow data. Each team has a different tool, a different dataset, and a different theory.",
    "Cirries ends this chaos by providing the one thing that every team can trust: a <strong>single, indisputable source of truth</strong>. By capturing and analyzing 100% of packets in real-time, we provide an unshakeable foundation of evidence.",
  ],
  primaryCta = {
    label: "See Your Network Clearly",
    href: "/contact",
  },
  secondaryCta = { label: "View All Solutions", href: "/solutions" },
} = Astro.props;

// Mobile network nodes for visualization
const mobileNodes = [
  { type: "ran", label: "RAN", angle: -60, distance: 155, color: "#8B5CF6", faIcon: "fa-solid fa-tower-cell" },
  { type: "core", label: "5G Core", angle: 0, distance: 165, color: "#3B82F6", faIcon: "fa-solid fa-server" },
  { type: "edge", label: "Edge", angle: 60, distance: 155, color: "#10B981", faIcon: "fa-solid fa-microchip" },
  { type: "transport", label: "Transport", angle: 120, distance: 155, color: "#F59E0B", faIcon: "fa-solid fa-network-wired" },
  { type: "cloud", label: "Cloud", angle: 180, distance: 165, color: "#0078D4", faIcon: "fa-solid fa-cloud" },
  { type: "endpoint", label: "Endpoints", angle: -120, distance: 155, color: "#EC4899", faIcon: "fa-solid fa-mobile-screen" },
];
---

<section class="meet-mobile-section" data-theme="light">
  <!-- Ambient background -->
  <div class="mobile-bg">
    <div class="mobile-gradient"></div>
    <div class="mobile-grid"></div>
    <div class="mobile-pattern"></div>
  </div>

  <Container size="xl">
    <div class="meet-mobile">
      <!-- Left: Content -->
      <div class="meet-mobile__content">
        <span class="meet-mobile__eyebrow">{eyebrow}</span>

        <h2 class="meet-mobile__title">
          {title}
          <span>{highlightText}</span>
        </h2>

        {paragraphs.map((text) => <p class="meet-mobile__text" set:html={text} />)}

        <div class="meet-mobile__actions">
          <Button href={primaryCta.href} variant="primary">
            {primaryCta.label}
          </Button>
          <Button href={secondaryCta.href} variant="outline-dark">
            {secondaryCta.label}
          </Button>
        </div>
      </div>

      <!-- Right: Mobile Network Visualization -->
      <div class="mobile-network" id="mobile-network">
        <!-- SVG for connection lines -->
        <svg class="mobile-connections" viewBox="0 0 400 400" id="mobile-connections-svg">
          <defs>
            <linearGradient id="mobile-flow-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color: var(--color-primary-10)"></stop>
              <stop offset="50%" style="stop-color: var(--color-primary-50)"></stop>
              <stop offset="100%" style="stop-color: var(--color-primary-10)"></stop>
            </linearGradient>
          </defs>
          <g id="mobile-mesh-lines"></g>
          <g id="mobile-connection-lines"></g>
        </svg>

        <!-- Central Hub - DART-AI Command Center -->
        <div class="mobile-hub" id="mobile-hub">
          <div class="hub-pulse"></div>
          <div class="hub-ring hub-ring-1"></div>
          <div class="hub-ring hub-ring-2"></div>
          <div class="hub-ring hub-ring-3"></div>
          <div class="hub-core">
            <img src={DartLogoLight.src} alt="DART-AI" />
          </div>
          <div class="hub-label">Ground Truth</div>
        </div>

        <!-- Mobile Network Nodes -->
        {mobileNodes.map((node, index) => (
          <div
            class={`mobile-node mobile-node--${node.type}`}
            data-angle={node.angle}
            data-distance={node.distance}
            data-index={index}
            data-color={node.color}
            style={`--node-delay: ${index * 0.12}s; --node-color: ${node.color}`}
          >
            <div class="node-icon-wrapper">
              <div class="node-icon">
                <i class={`${node.faIcon} node-fa-icon`}></i>
              </div>
              <div class="node-pulse"></div>
            </div>
            <span class="node-label">{node.label}</span>
          </div>
        ))}

        <!-- Data flow packets container -->
        <div class="data-flows" id="mobile-data-flows"></div>

        <!-- Signal rings -->
        <div class="signal-ring signal-ring-1"></div>
        <div class="signal-ring signal-ring-2"></div>
      </div>
    </div>
  </Container>
</section>

<style>
  .meet-mobile-section {
    position: relative;
    padding: var(--space-20) 0;
    background: var(--color-bg-primary);
    overflow: hidden;
  }

  .mobile-bg {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .mobile-gradient {
    position: absolute;
    inset: 0;
    background:
      radial-gradient(ellipse 100% 80% at 75% 40%, var(--color-primary-4) 0%, transparent 50%),
      radial-gradient(ellipse 70% 50% at 20% 70%, var(--color-primary-2) 0%, transparent 45%),
      radial-gradient(ellipse 50% 40% at 85% 85%, var(--color-primary-2) 0%, transparent 40%),
      linear-gradient(180deg, var(--color-bg-primary) 0%, #f8f9fa 50%, #f5f5f7 100%);
  }

  .mobile-grid {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(var(--color-black-1) 1px, transparent 1px),
      linear-gradient(90deg, var(--color-black-1) 1px, transparent 1px);
    background-size: 40px 40px;
    mask-image: radial-gradient(ellipse 85% 75% at 65% 50%, black 15%, transparent 70%);
    -webkit-mask-image: radial-gradient(ellipse 85% 75% at 65% 50%, black 15%, transparent 70%);
  }

  .mobile-pattern {
    position: absolute;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.015;
    mix-blend-mode: multiply;
  }

  /* Content Layout */
  .meet-mobile {
    position: relative;
    z-index: 1;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--space-12);
    align-items: center;
  }

  .meet-mobile__eyebrow {
    display: inline-block;
    margin-bottom: var(--space-4);
    font-family: var(--font-display);
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    color: var(--color-primary, #EA242B);
  }

  .meet-mobile__title {
    font-family: var(--font-display);
    font-size: clamp(1.75rem, 3.5vw, 2.75rem);
    font-weight: var(--font-bold);
    line-height: 1.15;
    letter-spacing: var(--tracking-tight);
    color: var(--color-text-primary);
    margin-bottom: var(--space-6);
  }

  .meet-mobile__title span {
    display: block;
    color: var(--color-primary, #EA242B);
  }

  .meet-mobile__text {
    font-family: var(--font-body);
    font-size: var(--text-base);
    line-height: var(--leading-relaxed);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-4);
  }

  .meet-mobile__text :global(strong) {
    color: var(--color-text-primary);
    font-weight: var(--font-semibold);
  }

  .meet-mobile__actions {
    display: flex;
    gap: var(--space-4);
    margin-top: var(--space-8);
  }

  /* Mobile Network Visualization */
  .mobile-network {
    position: relative;
    width: 100%;
    aspect-ratio: 1;
    max-width: 500px;
    margin: 0 auto;
  }

  .mobile-connections {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
  }

  /* Central Hub */
  .mobile-hub {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 130px;
    height: 130px;
    z-index: 10;
  }

  .hub-pulse {
    position: absolute;
    inset: -25px;
    border-radius: 50%;
    background: radial-gradient(circle, var(--color-primary-12) 0%, transparent 70%);
    animation: hubPulse 3s ease-in-out infinite;
  }

  @keyframes hubPulse {
    0%, 100% { transform: scale(1); opacity: 0.6; }
    50% { transform: scale(1.2); opacity: 0.9; }
  }

  .hub-ring {
    position: absolute;
    border-radius: 50%;
    border: 1px solid var(--color-primary-20);
  }

  .hub-ring-1 {
    inset: -12px;
    animation: ringRotate 25s linear infinite;
    border-style: dashed;
    border-color: var(--color-primary-15);
  }

  .hub-ring-2 {
    inset: -28px;
    animation: ringRotate 35s linear infinite reverse;
    border-style: dotted;
    border-color: var(--color-primary-10);
  }

  .hub-ring-3 {
    inset: -48px;
    animation: ringRotate 50s linear infinite;
    border-style: dashed;
    border-width: 1px;
    border-color: var(--color-primary-6);
  }

  @keyframes ringRotate {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .hub-core {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-white-98);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 50%;
    border: 1px solid var(--color-border-light);
    box-shadow:
      0 12px 40px var(--color-black-10),
      0 0 0 1px var(--color-white-80) inset,
      0 0 60px var(--color-primary-5);
    z-index: 12;
  }

  .hub-core img {
    width: 60%;
    height: auto;
  }

  .hub-label {
    position: absolute;
    bottom: -32px;
    left: 50%;
    transform: translateX(-50%);
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    font-weight: var(--font-medium);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--color-primary, #EA242B);
    white-space: nowrap;
    padding: var(--space-1) var(--space-2-5);
    background: var(--color-primary-8);
    border-radius: var(--radius-sm);
  }

  /* Signal Rings */
  .signal-ring {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border: 1px dashed var(--color-primary-8);
    border-radius: 50%;
    pointer-events: none;
    z-index: 0;
  }

  .signal-ring-1 {
    width: 75%;
    height: 75%;
  }

  .signal-ring-2 {
    width: 90%;
    height: 90%;
  }

  /* Mobile Nodes */
  .mobile-node {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--space-1-5);
    transform: translate(-50%, -50%);
    opacity: 0;
    animation: nodeAppear 0.5s ease forwards;
    animation-delay: var(--node-delay);
    z-index: 8;
  }

  @keyframes nodeAppear {
    from { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
    to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
  }

  .node-icon-wrapper {
    position: relative;
  }

  .node-icon {
    position: relative;
    width: 52px;
    height: 52px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--color-bg-primary);
    border: 1.5px solid var(--color-border-light);
    border-radius: var(--radius-lg);
    box-shadow: 0 2px 10px var(--color-black-6), 0 4px 20px var(--color-black-3);
    transition: all 0.3s ease;
  }

  .node-fa-icon {
    font-size: 1.25rem;
    color: var(--node-color);
    transition: all 0.3s ease;
  }

  .node-pulse {
    position: absolute;
    inset: -4px;
    border-radius: 18px;
    border: 2px solid var(--node-color);
    opacity: 0;
    animation: nodePulse 2.5s ease-out infinite;
    animation-delay: var(--node-delay);
  }

  @keyframes nodePulse {
    0% { transform: scale(0.9); opacity: 0.5; }
    100% { transform: scale(1.3); opacity: 0; }
  }

  .mobile-node:hover .node-icon {
    border-color: var(--node-color);
    transform: scale(1.08) translateY(-2px);
    box-shadow:
      0 4px 16px color-mix(in srgb, var(--node-color) 25%, transparent),
      0 8px 24px var(--color-black-8);
  }

  .mobile-node:hover .node-fa-icon {
    transform: scale(1.1);
  }

  .node-label {
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    font-weight: var(--font-medium);
    text-transform: uppercase;
    letter-spacing: 0.03em;
    color: var(--color-text-muted);
    white-space: nowrap;
  }

  /* Data Flows */
  .data-flows {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 6;
  }

  :global(.mobile-data-flow) {
    position: absolute;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    opacity: 0;
    z-index: 9;
  }

  :global(.mobile-data-flow--healthy) {
    background: #22c55e;
    box-shadow: 0 0 12px var(--color-success);
  }

  :global(.mobile-data-flow--warning) {
    background: #f59e0b;
    box-shadow: 0 0 12px var(--color-warning);
  }

  :global(.mobile-connection-line) {
    stroke: var(--color-primary-12);
    stroke-width: 1.5;
    fill: none;
    stroke-dasharray: 6 4;
    animation: dashFlow 25s linear infinite;
  }

  :global(.mobile-mesh-line) {
    stroke: var(--color-black-3);
    stroke-width: 1;
    fill: none;
  }

  @keyframes dashFlow {
    to { stroke-dashoffset: -120; }
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .meet-mobile {
      grid-template-columns: 1fr;
      gap: var(--space-12);
    }

    .mobile-network {
      max-width: 420px;
    }
  }

  @media (max-width: 768px) {
    .meet-mobile-section {
      padding: var(--space-12) 0;
    }

    .meet-mobile__title {
      font-size: var(--text-2xl);
    }

    .meet-mobile__actions {
      flex-direction: column;
    }

    .mobile-network {
      max-width: 340px;
    }

    .mobile-hub {
      width: 100px;
      height: 100px;
    }

    .hub-ring-1 { inset: -10px; }
    .hub-ring-2 { inset: -22px; }
    .hub-ring-3 { inset: -38px; }

    .hub-label {
      font-size: 0.5rem;
      bottom: -28px;
    }

    .node-icon {
      width: 44px;
      height: 44px;
    }

    .node-fa-icon {
      font-size: 1rem;
    }

    .node-label {
      display: none;
    }
  }
</style>

<script>
  import "../../../scripts/mobile-network.ts";
</script>
